
-----

### ğŸš€ ì¶”ì²œ ì•„í‚¤í…ì²˜ (í”„ë¦¬í‹°ì–´ ìµœì í™”)

EC2(`t2.micro` ë˜ëŠ” `t3.micro`)ëŠ” **RAMì´ 1GB**ë°–ì— ì•ˆ ëœë‹¤. í˜„ì¬ ìŠ¤íƒ(Java + DB + Redis)ì„ í•œ ê³³ì— ë‹¤ ë„ìš°ë©´, ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì„œë²„ ê°€ ë‹¤ìš´ë˜ê¸° ë•Œë¬¸ì— ë‚˜ëˆˆë‹¤.

1.  **Frontend (React):** **AWS S3** (ì •ì  ì›¹ í˜¸ìŠ¤íŒ…) + **CloudFront** (ì„ íƒ, HTTPSìš©)
      * *ì´ìœ :* EC2 ìì›ì„ ì“°ì§€ ì•Šê³ , ë¹ ë¥´ê³ , ë¬´ë£Œ ë²”ìœ„ê°€ ë„‰ë„‰í•¨.
2.  **Backend (Spring Boot + Redis):** **AWS EC2**
      * *ì´ìœ :* ì„œë²„ ë¡œì§ êµ¬ë™.
3.  **Database (MariaDB):** **AWS RDS**
      * *ì´ìœ :* EC2 ë©”ëª¨ë¦¬ë¥¼ ì•„ë¼ê¸° ìœ„í•´ DBë¥¼ ë¶„ë¦¬. (í”„ë¦¬í‹°ì–´ì—ì„œ `db.t3.micro` ë¬´ë£Œ ì œê³µ)

-----

### 1ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± (AWS RDS)

DBë¥¼ ë§Œë“¤ê¸°.

1.  AWS Consoleì—ì„œ **RDS** ê²€ìƒ‰ -\> **ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±**.
2.  **í‘œì¤€ ìƒì„±** -\> **MariaDB** ì„ íƒ.
3.  **í…œí”Œë¦¿**: **í”„ë¦¬í‹°ì–´** ì„ íƒ (ì¤‘ìš”\!).
4.  **ì„¤ì •**: DB ì¸ìŠ¤í„´ìŠ¤ ì‹ë³„ì, ë§ˆìŠ¤í„° ì‚¬ìš©ì ì´ë¦„/ë¹„ë²ˆ ì„¤ì •.
5.  **ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±**: `db.t3.micro` (ë˜ëŠ” t2.micro) í™•ì¸.
6.  **ì—°ê²°**:
      * **í¼ë¸”ë¦­ ì•¡ì„¸ìŠ¤**: 'ì•„ë‹ˆìš”' (ë³´ì•ˆìƒ EC2ì—ì„œë§Œ ì ‘ì†í•˜ê²Œ í•˜ëŠ” ê²Œ ì •ì„ì´ì§€ë§Œ, í¸ì˜ìƒ ê°œë°œ ì¤‘ì—” 'ì˜ˆ'ë¡œ í•´ë„ ë¨).
      * **VPC ë³´ì•ˆ ê·¸ë£¹**: 'ìƒˆë¡œ ìƒì„±' (ì´ë¦„ ê¸°ì–µí•´ë‘ê¸°, ì˜ˆ: `rds-sg`).
7.  ìƒì„± ì™„ë£Œ í›„ **ì—”ë“œí¬ì¸íŠ¸ ì£¼ì†Œ**ë¥¼ ë³µì‚¬.

-----

### 2ë‹¨ê³„: ë°±ì—”ë“œ ë°°í¬ (AWS EC2)

ì„œë²„ ì»´í“¨í„°ë¥¼ ë¹Œë ¤ì„œ Spring Bootë¥¼ ë„ìš°ëŠ” ê³¼ì •.

#### 2-1. EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

1.  **EC2** -\> **ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘**.
2.  ì´ë¦„: `CompanyValue-Server`.
3.  **OS**: **Ubuntu Server 24.04 LTS** (ê°€ì¥ ë¬´ë‚œí•¨).
4.  **ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•**: `t2.micro` (í”„ë¦¬í‹°ì–´ ê°€ëŠ¥).
5.  **í‚¤ í˜ì–´**: ìƒˆ í‚¤ í˜ì–´ ìƒì„± (`.pem` íŒŒì¼ ë‹¤ìš´ë¡œë“œ í›„ ì•ˆì „í•œ ê³³ì— ë³´ê´€).
6.  **ë„¤íŠ¸ì›Œí¬ ì„¤ì •**:
      * ë³´ì•ˆ ê·¸ë£¹ ìƒì„±:
          * SSH (22): ë‚´ IPì—ì„œë§Œ í—ˆìš©.
          * TCP (8080): ìœ„ì¹˜ ë¬´ê´€ (Anywhere) -\> Spring Bootìš©.
          * TCP (6379): Redisìš© (ë³´ì•ˆìƒ ë‚´ EC2 ë‚´ë¶€ì—ì„œë§Œ ì“°ë©´ ì•ˆ ì—´ì–´ë„ ë¨).
7.  **ìŠ¤í† ë¦¬ì§€**: í”„ë¦¬í‹°ì–´ëŠ” 30GBê¹Œì§€ ë¬´ë£Œë‹ˆê¹Œ **30GB**ë¡œ ì„¤ì • (ë„‰ë„‰í•˜ê²Œ).
8.  **ì‹œì‘**.

#### 2-2. EC2 ì ‘ì† ë° ì„¸íŒ… (í„°ë¯¸ë„)

ë‹¤ìš´ë¡œë“œ ë°›ì€ í‚¤ í˜ì–´(`key.pem`)ê°€ ìˆëŠ” í´ë”ì—ì„œ í„°ë¯¸ë„ì„ ì—°ë‹¤.

```bash
# 1. í‚¤ ê¶Œí•œ ì„¤ì • (ë§¥/ë¦¬ëˆ…ìŠ¤ ê¸°ì¤€, ìœˆë„ìš°ëŠ” Putty ì‚¬ìš©í•˜ê±°ë‚˜ CMDì—ì„œ ssh ëª…ë ¹)
chmod 400 key.pem

# 2. ì ‘ì† (í¼ë¸”ë¦­ IPëŠ” EC2 ì½˜ì†”ì—ì„œ í™•ì¸)
ssh -i "key.pem" ubuntu@<EC2_í¼ë¸”ë¦­_IP>

# 3. ì ‘ì† í›„ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ ë° Docker ì„¤ì¹˜
sudo apt update
sudo apt install docker.io docker-compose -y

# 4. í˜„ì¬ ì‚¬ìš©ì(ubuntu)ì—ê²Œ docker ê¶Œí•œ ë¶€ì—¬ (í•˜ê³  ë‚˜ì„œ ì¬ì ‘ì† í•„ìš”)
sudo usermod -aG docker $USER
exit
# (ë‹¤ì‹œ ssh ì ‘ì†)
```

#### 2-3. ë©”ëª¨ë¦¬ ìŠ¤ì™‘ ì„¤ì • (í•„ìˆ˜ â­)

`t2.micro`ëŠ” 1GB ë¨ì´ë¼ Java ëŒë¦¬ë©´ ë©ˆì¶œ ìˆ˜ ìˆë‹¤. í•˜ë“œë””ìŠ¤í¬ ì¼ë¶€ë¥¼ ë¨ì²˜ëŸ¼ ì“°ê²Œ ì„¤ì •í•´ì•¼ í•œë‹¤.

```bash
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
```

#### 2-4. í”„ë¡œì íŠ¸ ë°°í¬

ë¡œì»¬ì—ì„œ ë¹Œë“œí•œ JAR íŒŒì¼ì„ ì˜¬ë¦¬ëŠ” ê²Œ ì œì¼ ì•ˆì „í•˜ë‹¤. (EC2ì—ì„œ ë¹Œë“œí•˜ë©´ ë¨ í„°ì§ˆ í™•ë¥  ë†’ìŒ).

**[ë¡œì»¬ ì»´í“¨í„°ì—ì„œ]**

1.  `BACK/companyvalue/src/main/resources/application.properties` ìˆ˜ì • (RDS ì •ë³´ ì…ë ¥):
    ```properties
    spring.datasource.url=jdbc:mariadb://<RDS_ì—”ë“œí¬ì¸íŠ¸>:3306/value
    spring.datasource.username=<RDS_ì•„ì´ë””>
    spring.datasource.password=<RDS_ë¹„ë²ˆ>
    spring.data.redis.host=redis-container  <-- ë„ì»¤ ì»´í¬ì¦ˆ ì„œë¹„ìŠ¤ëª…
    ```
2.  ë¹Œë“œ:
    ```bash
    cd BACK/companyvalue
    ./gradlew clean build -x test  # í…ŒìŠ¤íŠ¸ ì œì™¸í•˜ê³  ë¹Œë“œ
    ```
3.  íŒŒì¼ ì „ì†¡ (`scp` ëª…ë ¹ì–´ ì‚¬ìš©):
    ```bash
    # JAR íŒŒì¼ ì „ì†¡
    scp -i "path/to/key.pem" build/libs/companyvalue-0.0.1-SNAPSHOT.jar ubuntu@<EC2_IP>:~/app.jar

    # docker-compose.yml ì „ì†¡ (í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìˆëŠ” ê²ƒ)
    scp -i "path/to/key.pem" ../../docker-compose.yml ubuntu@<EC2_IP>:~/docker-compose.yml
    ```

**[EC2 ì ‘ì†í•´ì„œ]**

1.  `docker-compose.yml` ìˆ˜ì • (`vi docker-compose.yml`):

      * **Backend**: `build: .` ë¶€ë¶„ì„ ì‚­ì œí•˜ê³  `image: openjdk:17-jdk-alpine` ê¸°ë°˜ìœ¼ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜, ê·¸ëƒ¥ `Dockerfile`ì„ ì¨ì•¼ í•˜ëŠ”ë°, **ê°€ì¥ ì‰¬ìš´ ê±´ `app.jar`ë¥¼ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” Dockerfileì„ ì¦‰ì„ì—ì„œ ë§Œë“œëŠ” ê²ƒ.**
      * **DB**: RDSë¥¼ ì“°ë‹ˆê¹Œ `mariadb` ì„¹ì…˜ì€ ì‚­ì œ (EC2 ë©”ëª¨ë¦¬ ì ˆì•½)

    **ìˆ˜ì •ëœ docker-compose.yml ì˜ˆì‹œ (EC2ìš©):**

    ```yaml
    version: '3.8'
    services:
      redis:
        image: redis:alpine
        container_name: company_redis
        ports:
          - "6379:6379"
        restart: always

      backend:
        container_name: company_backend
        image: openjdk:17-jdk-slim  # ê°€ë²¼ìš´ ìë°” ì´ë¯¸ì§€
        volumes:
          - ./app.jar:/app.jar      # ì•„ê¹Œ ì—…ë¡œë“œí•œ jar ì—°ê²°
        ports:
          - "8080:8080"
        environment:
          - SPRING_DATA_REDIS_HOST=company_redis
        command: java -jar /app.jar
        depends_on:
          - redis
        restart: always
    ```

2.  ì‹¤í–‰:

    ```bash
    docker-compose up -d
    ```

ì´ì œ `http://<EC2_IP>:8080`ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ë°±ì—”ë“œê°€ ëœ¬ë‹¤.

-----

### 3ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ (AWS S3)

#### 3-1. ë¡œì»¬ì—ì„œ ë¹Œë“œ

1.  `FRONT/companyvalue/.env` (ì—†ìœ¼ë©´ ìƒì„±) ì„¤ì •:
    ```
    VITE_API_URL=http://<EC2_í¼ë¸”ë¦­_IP>:8080
    ```
    *ì£¼ì˜: `axiosClient.ts`ì—ì„œ `baseURL`ì„ `import.meta.env.VITE_API_URL`ë¡œ ì“°ë„ë¡ ì½”ë“œ ìˆ˜ì • í•„ìš”.*
2.  ë¹Œë“œ:
    ```bash
    npm run build
    ```
    \-\> `dist` í´ë”ê°€ ìƒì„±ë¨.

#### 3-2. S3 ë²„í‚· ìƒì„± ë° ì—…ë¡œë“œ

1.  AWS Console -\> **S3** -\> **ë²„í‚· ë§Œë“¤ê¸°**.
2.  ì´ë¦„: ê³ ìœ í•œ ì´ë¦„ (ì˜ˆ: `my-company-value-portfolio`).
3.  **í¼ë¸”ë¦­ ì•¡ì„¸ìŠ¤ ì°¨ë‹¨ ì„¤ì •**: **"ëª¨ë“  í¼ë¸”ë¦­ ì•¡ì„¸ìŠ¤ ì°¨ë‹¨" ì²´í¬ í•´ì œ** (ê²½ê³  í™•ì¸ ì²´í¬).
4.  ìƒì„± í›„ í•´ë‹¹ ë²„í‚· í´ë¦­ -\> **ì—…ë¡œë“œ** -\> `dist` í´ë” ì•ˆì˜ **ëª¨ë“  íŒŒì¼ê³¼ í´ë”**ë¥¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­.

#### 3-3. ì •ì  ì›¹ í˜¸ìŠ¤íŒ… í™œì„±í™”

1.  ë²„í‚· ë‚´ **ì†ì„±** íƒ­ -\> ë§¨ ë°‘ **ì •ì  ì›¹ ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ…** -\> **í¸ì§‘**.
2.  **í™œì„±í™”** ì„ íƒ.
3.  ì¸ë±ìŠ¤ ë¬¸ì„œ: `index.html`.
4.  ì˜¤ë¥˜ ë¬¸ì„œ: `index.html` (React ë¼ìš°íŒ… ìœ„í•´ í•„ìˆ˜).
5.  ì €ì¥.

#### 3-4. ê¶Œí•œ ì„¤ì • (ë²„í‚· ì •ì±…)

1.  **ê¶Œí•œ** íƒ­ -\> **ë²„í‚· ì •ì±…** -\> **í¸ì§‘**.
2.  ì•„ë˜ JSON ë¶™ì—¬ë„£ê¸° (Bucket-Name ë¶€ë¶„ ìˆ˜ì •):
    ```json
    {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Sid": "PublicReadGetObject",
                "Effect": "Allow",
                "Principal": "*",
                "Action": "s3:GetObject",
                "Resource": "arn:aws:s3:::<ë„ˆì˜-ë²„í‚·-ì´ë¦„>/*"
            }
        ]
    }
    ```

ì´ì œ S3 ì†ì„± íƒ­ ë§¨ ë°‘ì— ìˆëŠ” **"ë²„í‚· ì›¹ ì‚¬ì´íŠ¸ ì—”ë“œí¬ì¸íŠ¸"** ì£¼ì†Œë¡œ ì ‘ì†í•˜ë©´ ë„¤ ì‚¬ì´íŠ¸ê°€ ëœ° ê±°ì•¼\!

-----

### âš ï¸ ì£¼ì˜ì‚¬í•­ & íŒ

1.  **CORS ì—ëŸ¬**: S3 ì£¼ì†Œ(`http://...s3-website...`)ì—ì„œ EC2(`http://...:8080`)ë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´ ë¸Œë¼ìš°ì €ê°€ ë§‰ì„ ìˆ˜ ìˆì–´.
      * ë°±ì—”ë“œ `SecurityConfig.java`ì˜ `corsConfigurationSource` ë©”ì„œë“œì— S3 ì£¼ì†Œë¥¼ í—ˆìš© ëª©ë¡(`allowedOrigins`)ì— ì¶”ê°€í•˜ê³  ë‹¤ì‹œ ë¹Œë“œí•´ì„œ ì˜¬ë ¤ì•¼ í•´.
2.  **RDS ë³´ì•ˆ ê·¸ë£¹**: RDSì˜ ë³´ì•ˆ ê·¸ë£¹ ì¸ë°”ìš´ë“œ ê·œì¹™ì— **EC2ì˜ ë³´ì•ˆ ê·¸ë£¹ ID**ë¥¼ í—ˆìš©í•´ì¤˜ì•¼ EC2ê°€ DBì— ì ‘ì†í•  ìˆ˜ ìˆì–´. (ì˜ ì•ˆë˜ë©´ ì¼ë‹¨ 'ìœ„ì¹˜ ë¬´ê´€' 0.0.0.0/0 ìœ¼ë¡œ ì—´ì–´ì„œ í…ŒìŠ¤íŠ¸)
3.  **ë¹„ìš©**:
      * EC2, RDS ëª¨ë‘ ì¼œë†“ìœ¼ë©´ 750ì‹œê°„/ì›” ë¬´ë£Œì•¼. (í•˜ë‚˜ì”©ë§Œ ì¼œë©´ í•œ ë‹¬ ë‚´ë‚´ ì¼œë„ ë¨).
      * ì•ˆ ì“¸ ë• `docker-compose stop`ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ë‚´ë¦¬ê³ , AWS Consoleì—ì„œ ì¸ìŠ¤í„´ìŠ¤ **ì¤‘ì§€**í•´ë‘ëŠ” ìŠµê´€ì„ ë“¤ì´ë©´ ì¢‹ì•„.

